import{g as X,r as n,j as e,O as Ee,m as F,n as Te,o as ls,X as T,T as Fe,D as Oe,R as cs,p as ds,q as os,a as ms,k as us,t as xs,b as fs,s as o,v as hs,C as N,e as y,w as z,x as A,y as E,B as x,z as Pe,c as C,d as ae,f as te,I,S as m,i as Le}from"./index-mjEV0DEk.js";import{E as ps}from"./ErrorState-0PO5aQxN.js";import{P as gs}from"./PageContainer-UeT_hR_D.js";import{P as js}from"./pencil-D9Hqk-Ve.js";import{F as vs}from"./flame-C9r6UAfc.js";import{A as ze}from"./award-rmq1NMA0.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=X("CalendarRange",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M17 14h-6",key:"bkmgh3"}],["path",{d:"M13 18H7",key:"bb0bb7"}],["path",{d:"M7 14h.01",key:"1qa3f1"}],["path",{d:"M17 18h.01",key:"1bdyru"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ys=X("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _s=X("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=X("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Ae=cs,Ss=ds,Me=n.forwardRef(({className:u,...t},f)=>e.jsx(Ee,{ref:f,className:F("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",u),...t}));Me.displayName=Ee.displayName;const re=n.forwardRef(({className:u,children:t,...f},h)=>e.jsxs(Ss,{children:[e.jsx(Me,{}),e.jsxs(Te,{ref:h,className:F("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",u),...f,children:[t,e.jsxs(ls,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(T,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));re.displayName=Te.displayName;const ne=({className:u,...t})=>e.jsx("div",{className:F("flex flex-col space-y-1.5 text-center sm:text-left",u),...t});ne.displayName="DialogHeader";const le=n.forwardRef(({className:u,...t},f)=>e.jsx(Fe,{ref:f,className:F("text-lg font-semibold leading-none tracking-tight",u),...t}));le.displayName=Fe.displayName;const ce=n.forwardRef(({className:u,...t},f)=>e.jsx(Oe,{ref:f,className:F("text-sm text-muted-foreground",u),...t}));ce.displayName=Oe.displayName;const ie=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],Ps=()=>{var De,$e;const{username:u}=os(),{user:t}=ms(),f=us(),{toast:h}=xs(),{t:i}=fs(),[Ue,R]=n.useState(!0),[Be,Y]=n.useState(!1),[He,J]=n.useState(!1),[a,O]=n.useState(null),[de,Ie]=n.useState({showAchievements:!0,showRoutine:!0}),[_,Xe]=n.useState(null),[oe,Ye]=n.useState([]),[V,Je]=n.useState({count:0,minutes:0,xp:0}),[Ve,Ge]=n.useState([]),[Ke,Qe]=n.useState(null),[me,G]=n.useState(0),[ue,K]=n.useState([]),[xe,fe]=n.useState([]),[Q,he]=n.useState([]),[We,M]=n.useState(!1),[D,pe]=n.useState(""),[ge,je]=n.useState(!1),[ve,W]=n.useState(0),[$,j]=n.useState("none"),[Ze,U]=n.useState(!1),[Z,Ne]=n.useState(""),[ee,ye]=n.useState(""),[w,_e]=n.useState(""),[q,P]=n.useState("idle"),L=n.useRef(null),[se,B]=n.useState(null),[S,H]=n.useState(void 0),we=n.useRef(null),[es,Se]=n.useState(!1);n.useEffect(()=>{(async()=>{var l;let s=u;if(!s&&t){const{data:d}=await o.from("profiles").select("username").eq("user_id",t.id).maybeSingle();s=(d==null?void 0:d.username)||void 0}if(!s&&!t){R(!1),f("/login",{replace:!0,state:{from:"/profile"}});return}if(!s){J(!0),R(!1);return}a&&((l=a.username)==null?void 0:l.toLowerCase())===s.toLowerCase()?Y(!0):(R(!0),J(!1));const c=await hs(o,s);if(!c.profile){J(!0),R(!1),Y(!1);return}O(c.profile),c.profile.profile_layout&&Ie(c.profile.profile_layout),Xe(c.streak),Ye(c.badges),Je(c.sessions),Ge((c.routine||[]).slice().sort((d,v)=>ie.indexOf(d.day)-ie.indexOf(v.day))),await be(c.profile.user_id),R(!1),Y(!1)})()},[u]),n.useEffect(()=>{(async()=>!t||!a||(await ss(t.id,a.user_id),t.id===a.user_id&&await b(t.id)))()},[t==null?void 0:t.id,a==null?void 0:a.user_id]);async function be(s){const{data:r}=await o.from("friendships").select("user_id,friend_user_id,status").eq("status","accepted").or(`user_id.eq.${s},friend_user_id.eq.${s}`),c=new Set;if((r||[]).forEach(l=>c.add(l.user_id===s?l.friend_user_id:l.user_id)),c.size){const{data:l}=await o.from("profiles").select("user_id,name,avatar_url,username").in("user_id",Array.from(c));G(c.size),K(l||[])}else G(0),K([])}async function ss(s,r){if(s===r){j("friends");return}const{data:c}=await o.from("friendships").select("status,user_id,friend_user_id").or(`and(user_id.eq.${s},friend_user_id.eq.${r}),and(user_id.eq.${r},friend_user_id.eq.${s})`).limit(1);if(!c||!c.length){j("none");return}const l=c[0];if(l.status==="accepted"){j("friends");return}if(l.status==="pending"){l.user_id===s?j("pending-out"):j("pending-in");return}j("none")}async function b(s){const[{data:r},{data:c}]=await Promise.all([o.from("friendships").select("user_id,friend_user_id,created_at").eq("friend_user_id",s).eq("status","pending"),o.from("friendships").select("user_id,friend_user_id,created_at").eq("user_id",s).eq("status","pending")]),l=(r||[]).map(g=>g.user_id),d=(c||[]).map(g=>g.friend_user_id),v=[...l,...d];if(v.length){const{data:g}=await o.from("profiles").select("user_id,name,avatar_url,username").in("user_id",v),qe=Object.fromEntries((g||[]).map(k=>[k.user_id,k]));fe(l.map(k=>qe[k]).filter(Boolean)),he(d.map(k=>qe[k]).filter(Boolean))}else fe([]),he([])}n.useEffect(()=>{if(!a||!t||t.id!==a.user_id)return;const s=c=>{var l,d;if(c.key==="kime-app-data")try{const v=(d=(l=JSON.parse(c.newValue||"{}"))==null?void 0:l.user)==null?void 0:d.avatar_url;v&&v!==a.avatar_url&&(O(g=>({...g,avatar_url:v})),W(Date.now()))}catch{}};window.addEventListener("storage",s);const r=c=>{const l=c.detail;(l==null?void 0:l.userId)===a.user_id&&(O(d=>({...d,avatar_url:l.avatar_url})),W(Date.now()))};return window.addEventListener("kime:avatar-updated",r),()=>{window.removeEventListener("storage",s),window.removeEventListener("kime:avatar-updated",r)}},[a==null?void 0:a.user_id,a==null?void 0:a.avatar_url,t==null?void 0:t.id]);const p=n.useMemo(()=>t&&a&&t.id===a.user_id,[t==null?void 0:t.id,a==null?void 0:a.user_id]),as=async()=>{!t||!a||p||$!=="none"||(je(!0),await o.from("friendships").upsert({user_id:t.id,friend_user_id:a.user_id,status:"pending"}),j("pending-out"),je(!1),h({description:i("profileSocial.friendRequestSent")}))},ts=async()=>{if(!t||!D.trim())return;const s=D.replace(/^@/,"").toLowerCase(),{data:r}=await o.from("profiles").select("user_id,username").or(`username.eq.${s},email.eq.${D}`).maybeSingle();if(!(r!=null&&r.user_id)){h({description:i("profileSocial.userNotFound")});return}if(r.user_id===t.id){h({description:i("profileSocial.cannotAddSelf")});return}await o.from("friendships").upsert({user_id:t.id,friend_user_id:r.user_id,status:"pending"}),h({description:i("profileSocial.friendRequestSent")}),pe(""),await b(t.id)},ke=async s=>{t&&(await o.from("friendships").delete().or(`and(user_id.eq.${t.id},friend_user_id.eq.${s}),and(user_id.eq.${s},friend_user_id.eq.${t.id})`),K(r=>r.filter(c=>c.user_id!==s)),G(r=>Math.max(0,r-1)),a!=null&&a.username&&Le(a.username),s===(a==null?void 0:a.user_id)&&j("none"),await b(t.id))},Ce=async s=>{t&&(await o.from("friendships").update({status:"accepted"}).match({user_id:s,friend_user_id:t.id}),await Promise.all([be(t.id),b(t.id)]),(a==null?void 0:a.user_id)===s&&j("friends"))},Re=async s=>{t&&(await o.from("friendships").delete().match({user_id:s,friend_user_id:t.id}),await b(t.id),(a==null?void 0:a.user_id)===s&&j("none"))},is=async s=>{t&&(await o.from("friendships").delete().match({user_id:t.id,friend_user_id:s}),await b(t.id),(a==null?void 0:a.user_id)===s&&j("none"))},rs=async()=>{if(!t||!p)return;let s=w.trim().toLowerCase();if(s&&s!==a.username){if(q==="taken"||q==="checking"){h({description:i("profileSocial.usernameIsTaken")});return}}else s=a.username;const r={user_id:t.id,name:Z||null,bio:ee||null,username:s};if(S&&se)try{const l=se.name.split(".").pop()||"jpg",d=`${t.id}-${Date.now()}.${l}`,{error:v}=await o.storage.from("avatars").upload(d,se,{upsert:!0});if(v)throw v;const{data:g}=o.storage.from("avatars").getPublicUrl(d);g!=null&&g.publicUrl&&(r.avatar_url=g.publicUrl)}catch{h({description:i("profileSocial.profilePhotoUpdateError")})}const{error:c}=await o.from("profiles").upsert(r);c?h({description:c.message}):(O(l=>({...l,name:Z,bio:ee,username:s,avatar_url:r.avatar_url||l.avatar_url})),a!=null&&a.username&&Le(a.username),r.avatar_url&&window.dispatchEvent(new CustomEvent("kime:avatar-updated",{detail:{userId:t.id,avatar_url:r.avatar_url}})),h({description:i("profileSocial.profileSynced")}),U(!1),B(null),H(void 0),W(Date.now()))},ns=async()=>{try{await navigator.clipboard.writeText(window.location.href),Se(!0),setTimeout(()=>Se(!1),1500),h({description:i("profileSocial.profileLinkCopied")})}catch{}};return n.useEffect(()=>{if(p){if(L.current&&clearTimeout(L.current),!w.trim()||w.trim().toLowerCase()===(a==null?void 0:a.username)){P("idle");return}return P("checking"),L.current=setTimeout(async()=>{const s=w.trim().toLowerCase(),{data:r}=await o.from("profiles").select("user_id").eq("username",s).maybeSingle();!r||r.user_id===(t==null?void 0:t.id)?P("available"):P("taken")},400),()=>{L.current&&clearTimeout(L.current)}}},[w,p,a==null?void 0:a.username,t==null?void 0:t.id]),n.useEffect(()=>()=>{S&&URL.revokeObjectURL(S)},[S]),Ue?e.jsx(bs,{}):He||!a?e.jsx(ps,{title:i("profileSocial.userNotFoundSimple"),message:i("profileSocial.profileNotExist"),retryLabel:i("common.retry","Retry"),onRetry:()=>window.location.reload()}):e.jsxs(gs,{title:(a==null?void 0:a.name)||i("profileSocial.profile","Profile"),className:"space-y-8 min-w-0 stagger-children",busy:Be,children:[e.jsx(N,{variant:"subtle",children:e.jsxs(y,{className:"pt-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start gap-4",children:[e.jsxs(z,{className:"h-20 w-20",children:[e.jsx(A,{src:a.avatar_url?`${a.avatar_url}${a.avatar_url.includes("?")?"&":"?"}v=${ve}`:void 0}),e.jsx(E,{children:((De=a.name)==null?void 0:De.slice(0,1))||"U"})]}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight font-space-grotesk truncate",children:a.name||i("profileSocial.noName")}),e.jsxs("span",{className:"text-sm text-muted-foreground truncate",children:["@",a.username]})]}),a.bio&&e.jsx("p",{className:"text-sm mt-2 max-w-prose leading-relaxed",children:a.bio}),e.jsxs("div",{className:"flex items-center gap-6 text-sm mt-3",children:[e.jsxs("button",{type:"button",className:"hover:underline",onClick:()=>M(!0),children:[e.jsx("strong",{children:me})," ",i("profileSocial.friends")]}),e.jsxs("span",{className:"hidden md:inline text-muted-foreground",children:[i("profileSocial.joined")," ",new Date(a.created_at).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 self-start",children:[p&&e.jsxs(x,{size:"sm",variant:"outline",onClick:()=>{Ne(a.name||""),ye(a.bio||""),_e(a.username||""),P("idle"),B(null),H(void 0),U(!0)},children:[e.jsx(js,{className:"h-4 w-4 mr-1"})," ",i("profileSocial.editProfileShort")]}),!p&&$==="none"&&e.jsx(x,{size:"sm",onClick:as,disabled:ge,children:ge?"...":i("profileSocial.addFriend")}),!p&&$==="pending-out"&&e.jsx(x,{size:"sm",variant:"outline",disabled:!0,children:i("profileSocial.requested")}),!p&&$==="pending-in"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(x,{size:"sm",onClick:()=>Ce(a.user_id),variant:"default",children:[e.jsx(Pe,{className:"h-4 w-4 mr-1"}),i("profileSocial.accept")]}),e.jsxs(x,{size:"sm",variant:"outline",onClick:()=>Re(a.user_id),children:[e.jsx(T,{className:"h-4 w-4 mr-1"}),i("profileSocial.decline")]})]}),!p&&$==="friends"&&e.jsx(x,{size:"sm",variant:"outline",onClick:()=>ke(a.user_id),children:i("profileSocial.unfriend")}),e.jsxs(x,{size:"sm",variant:"outline",onClick:ns,children:[e.jsx(ys,{className:"h-4 w-4 mr-1"})," ",i(es?"profileSocial.copied":"profileSocial.share")]})]})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-2 md:grid-cols-5 gap-3 text-sm",children:[e.jsxs("div",{className:"rounded-md bg-muted/30 p-3",children:[e.jsx("div",{className:"text-muted-foreground",children:i("profileSocial.sessionsLabel")||"Sessions"}),e.jsx("div",{className:"font-medium text-lg",children:V.count})]}),e.jsxs("div",{className:"rounded-md bg-muted/30 p-3",children:[e.jsx("div",{className:"text-muted-foreground",children:i("profileSocial.minutesLabel")||"Minutes"}),e.jsx("div",{className:"font-medium text-lg",children:V.minutes})]}),e.jsxs("div",{className:"rounded-md bg-muted/30 p-3",children:[e.jsx("div",{className:"text-muted-foreground",children:i("profileSocial.xpLabel")||"XP"}),e.jsx("div",{className:"font-medium text-lg",children:V.xp})]}),e.jsxs("div",{className:"rounded-md bg-muted/30 p-3",children:[e.jsxs("div",{className:"text-muted-foreground flex items-center gap-1",children:[e.jsx(vs,{className:"h-3 w-3"})," ",i("profileSocial.currentStreakShort")||"Current streak"]}),e.jsx("div",{className:"font-medium text-lg",children:(_==null?void 0:_.current_streak)||0})]}),e.jsxs("div",{className:"rounded-md bg-muted/30 p-3",children:[e.jsx("div",{className:"text-muted-foreground",children:i("profileSocial.bestStreakShort")||"Best streak"}),e.jsx("div",{className:"font-medium text-lg",children:(_==null?void 0:_.best_streak)||0})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[e.jsx("div",{className:"lg:col-span-7 space-y-6",children:de.showAchievements!==!1&&e.jsxs(N,{variant:"subtle",children:[e.jsxs(C,{children:[e.jsxs(ae,{size:"lg",className:"flex items-center gap-2",children:[e.jsx(ze,{className:"h-5 w-5 text-primary"})," ",i("profileSocial.achievementsTitle")]}),e.jsx(te,{children:i("profileSocial.achievementsDesc")})]}),e.jsx(y,{children:oe.length?e.jsx("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-3",children:oe.map(s=>e.jsxs("div",{className:"rounded-md bg-muted/30 p-3 text-sm flex items-center gap-3",children:[e.jsx(ze,{className:"h-4 w-4 text-primary"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:s.name||"Achievement"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(s.created_at).toLocaleDateString()})]})]},s.id))}):e.jsx("p",{className:"text-sm text-muted-foreground mt-4",children:i("profileSocial.noAchievementsYet")})})]})}),e.jsxs("div",{className:"lg:col-span-5 space-y-6",children:[de.showRoutine!==!1&&e.jsxs(N,{variant:"subtle",children:[e.jsxs(C,{children:[e.jsxs(ae,{size:"lg",className:"flex items-center gap-2",children:[e.jsx(Ns,{className:"h-5 w-5 text-primary"})," ",i("profileSocial.weeklyRoutineTitle")]}),e.jsx(te,{children:i("profileSocial.weeklyRoutineDesc")})]}),e.jsx(y,{children:e.jsx("div",{className:"rounded-md border divide-y text-sm",children:ie.map(s=>{const r=Ve.find(d=>d.day===s),c=!r,l=Ke===s;return e.jsxs("div",{className:`group ${l?"bg-muted/30":""}`,children:[e.jsx("button",{type:"button",onClick:()=>Qe(l?null:s),className:`w-full flex items-center justify-between p-3 text-left ${c?"":"hover:bg-muted/30"}`,children:e.jsxs("div",{className:"flex items-center gap-4 flex-1 min-w-0",children:[e.jsx("div",{className:"text-muted-foreground capitalize w-24 shrink-0",children:s}),r?e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"font-medium truncate flex items-center gap-2",children:[e.jsx("span",{children:r.name}),r.exercises&&r.exercises.length>0&&e.jsx("span",{className:"text-xs rounded-full bg-primary/10 text-primary px-2 py-0.5",children:r.exercises.length})]}),e.jsxs("div",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[e.jsx(_s,{className:"h-3 w-3"})," ",r.duration," min",r.focus?` • ${r.focus}`:""]})]}):e.jsx("div",{className:"text-xs text-muted-foreground",children:i("profileSocial.restDay")}),r&&r.exercises&&r.exercises.length>0&&e.jsx("span",{className:"text-xs text-muted-foreground ml-auto",children:l?"−":"+"})]})}),l&&r&&r.exercises&&r.exercises.length>0&&e.jsx("div",{className:"px-3 pb-4 pt-1 space-y-2",children:r.exercises.map(d=>e.jsxs("div",{className:"rounded-md border bg-background/60 p-3 flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"font-medium text-sm truncate",children:d.name}),d.reps&&e.jsx("div",{className:"text-xs text-muted-foreground shrink-0",children:d.reps})]}),(d.modification||d.tips)&&e.jsxs("div",{className:"text-[11px] leading-relaxed text-muted-foreground space-y-1",children:[d.modification&&e.jsxs("p",{children:[e.jsxs("span",{className:"font-medium",children:[i("workouts.mod","Mod"),":"]})," ",d.modification]}),d.tips&&e.jsxs("p",{children:[e.jsxs("span",{className:"font-medium",children:[i("workouts.tips","Tips"),":"]})," ",d.tips]})]})]},d.order_int))})]},s)})})})]}),e.jsxs(N,{variant:"subtle",children:[e.jsxs(C,{children:[e.jsxs(ae,{size:"lg",className:"flex items-center gap-2",children:[e.jsx(ws,{className:"h-5 w-5 text-primary"})," ",i("profileSocial.socialTitle")]}),e.jsx(te,{children:i("profileSocial.socialDesc")})]}),e.jsxs(y,{className:"space-y-4",children:[p&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{placeholder:i("profileSocial.findFriendsPlaceholder"),value:D,onChange:s=>pe(s.target.value)}),e.jsx(x,{size:"sm",onClick:ts,disabled:!D.trim(),children:i("profileSocial.add")})]}),e.jsxs("div",{className:"flex flex-col gap-4 text-sm",children:[e.jsx("div",{className:"flex items-center gap-6",children:e.jsxs("button",{type:"button",className:"hover:underline",onClick:()=>M(!0),children:[e.jsx("strong",{children:me})," ",i("profileSocial.friends")]})}),p&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"font-medium",children:i("profileSocial.requests")}),e.jsxs("div",{className:"space-y-2",children:[xe.map(s=>{var r;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>f(`/profile/${s.username||s.user_id}`),className:"flex items-center gap-2 flex-1 text-left hover:underline",children:[e.jsxs(z,{className:"h-8 w-8",children:[e.jsx(A,{src:s.avatar_url?`${s.avatar_url}${s.avatar_url.includes("?")?"&":"?"}v=${Date.now()}`:void 0}),e.jsx(E,{children:((r=s.name)==null?void 0:r.slice(0,1))||"?"})]}),e.jsx("span",{className:"truncate",children:s.name||"User"})]}),e.jsx(x,{size:"icon",variant:"secondary",onClick:()=>Ce(s.user_id),"aria-label":i("profileSocial.accept"),children:e.jsx(Pe,{className:"h-4 w-4"})}),e.jsx(x,{size:"icon",variant:"ghost",onClick:()=>Re(s.user_id),"aria-label":i("profileSocial.decline"),children:e.jsx(T,{className:"h-4 w-4"})})]},s.user_id)}),xe.length===0&&e.jsx("p",{className:"text-xs text-muted-foreground",children:i("profileSocial.noPending")})]}),Q.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"font-medium",children:i("profileSocial.pendingCount",{count:Q.length})}),Q.map(s=>{var r;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>f(`/profile/${s.username||s.user_id}`),className:"flex items-center gap-2 flex-1 text-left hover:underline",children:[e.jsxs(z,{className:"h-8 w-8",children:[e.jsx(A,{src:s.avatar_url?`${s.avatar_url}${s.avatar_url.includes("?")?"&":"?"}v=${Date.now()}`:void 0}),e.jsx(E,{children:((r=s.name)==null?void 0:r.slice(0,1))||"?"})]}),e.jsx("span",{className:"truncate",children:s.name||"User"})]}),e.jsx(x,{size:"icon",variant:"ghost",onClick:()=>is(s.user_id),"aria-label":"Cancel",children:e.jsx(T,{className:"h-4 w-4"})})]},s.user_id)})]})]})]})]})]})]})]}),e.jsx(Ae,{open:We,onOpenChange:M,children:e.jsxs(re,{children:[e.jsxs(ne,{children:[e.jsx(le,{children:i("profileSocial.friendsModalTitle")}),e.jsx(ce,{children:i("profileSocial.friendsModalDesc")})]}),e.jsx("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto pr-1",children:ue.length?ue.map(s=>{var r;return e.jsxs("div",{className:"flex items-center gap-3 group",children:[e.jsxs("button",{onClick:()=>{M(!1),f(`/profile/${s.username||s.user_id}`)},className:"flex items-center gap-3 text-left flex-1 hover:bg-muted/30 p-2 rounded-md",children:[e.jsxs(z,{className:"h-8 w-8",children:[e.jsx(A,{src:s.avatar_url?`${s.avatar_url}${s.avatar_url.includes("?")?"&":"?"}v=${Date.now()}`:void 0}),e.jsx(E,{children:((r=s.name)==null?void 0:r.slice(0,1))||"?"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:s.name||"User"}),s.username&&e.jsxs("p",{className:"text-xs text-muted-foreground truncate",children:["@",s.username]})]})]}),p&&s.user_id!==(t==null?void 0:t.id)&&e.jsx(x,{size:"icon",variant:"ghost",className:"opacity-60 hover:opacity-100",onClick:()=>ke(s.user_id),"aria-label":"Remove friend",children:e.jsx(T,{className:"h-4 w-4"})})]},s.user_id)}):e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:i("profileSocial.noFriendsYet")})})]})}),e.jsx(Ae,{open:Ze,onOpenChange:U,children:e.jsxs(re,{className:"max-w-lg",children:[e.jsxs(ne,{children:[e.jsx(le,{children:i("profileSocial.editProfileShort")}),e.jsx(ce,{children:i("profileSocial.basicDetails")||"Basic details"})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"relative",children:e.jsxs(z,{className:"h-16 w-16",children:[e.jsx(A,{src:S||(a.avatar_url?`${a.avatar_url}${a.avatar_url.includes("?")?"&":"?"}v=${ve}`:void 0)}),e.jsx(E,{children:(($e=a.name)==null?void 0:$e.slice(0,1))||"U"})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm font-medium",children:i("profileSocial.profilePhoto")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(x,{size:"sm",variant:"outline",onClick:()=>{var s;return(s=we.current)==null?void 0:s.click()},children:i("profileSocial.profilePhoto")||"Photo"}),S&&e.jsx(x,{size:"sm",variant:"ghost",onClick:()=>{H(void 0),B(null)},children:i("profileSocial.cancel")})]}),e.jsx("input",{ref:we,type:"file",accept:"image/*",className:"hidden",onChange:s=>{var l;const r=(l=s.target.files)==null?void 0:l[0];if(!r)return;if(r.size>2*1024*1024){h({description:"Max 2MB"});return}B(r);const c=URL.createObjectURL(r);H(c)}})]})]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:i("profileSocial.username")}),e.jsx(I,{value:w,onChange:s=>_e(s.target.value)}),q==="checking"&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:i("profileSocial.checkingUsername")}),q==="available"&&e.jsx("p",{className:"text-xs text-green-600 mt-1",children:i("profileSocial.usernameIsAvailable")}),q==="taken"&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:i("profileSocial.usernameIsTaken")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:i("profileSocial.name")||"Name"}),e.jsx(I,{value:Z,onChange:s=>Ne(s.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:i("profileSocial.bio")}),e.jsx(I,{value:ee,onChange:s=>ye(s.target.value)})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(x,{variant:"outline",onClick:()=>U(!1),children:i("profileSocial.cancel")}),e.jsx(x,{onClick:rs,children:i("profileSocial.save")})]})]})})]})},bs=()=>e.jsxs("div",{className:"space-y-8 stagger-children",children:[e.jsx(N,{variant:"subtle",children:e.jsxs(y,{className:"pt-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start gap-4",children:[e.jsx(m,{className:"h-20 w-20 rounded-full"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(m,{className:"h-6 w-48"}),e.jsx(m,{className:"h-4 w-32"}),e.jsx(m,{className:"h-3 w-72"}),e.jsxs("div",{className:"flex gap-6 mt-2",children:[e.jsx(m,{className:"h-4 w-24"}),e.jsx(m,{className:"h-4 w-32"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{className:"h-8 w-24"}),e.jsx(m,{className:"h-8 w-24"})]})]}),e.jsx("div",{className:"mt-6 grid grid-cols-2 md:grid-cols-5 gap-3 text-sm",children:Array.from({length:5}).map((u,t)=>e.jsx(m,{className:"h-20 w-full rounded-md"},t))})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[e.jsx("div",{className:"lg:col-span-7 space-y-6",children:e.jsxs(N,{variant:"subtle",children:[e.jsxs(C,{children:[e.jsx(m,{className:"h-6 w-40"}),e.jsx(m,{className:"h-4 w-64 mt-2"})]}),e.jsx(y,{children:e.jsx("div",{className:"grid grid-cols-2 gap-3",children:Array.from({length:4}).map((u,t)=>e.jsx(m,{className:"h-14 w-full rounded-md"},t))})})]})}),e.jsxs("div",{className:"lg:col-span-5 space-y-6",children:[e.jsxs(N,{variant:"subtle",children:[e.jsxs(C,{children:[e.jsx(m,{className:"h-6 w-40"}),e.jsx(m,{className:"h-4 w-56 mt-2"})]}),e.jsx(y,{children:e.jsx("div",{className:"space-y-2",children:Array.from({length:7}).map((u,t)=>e.jsx(m,{className:"h-10 w-full rounded-md"},t))})})]}),e.jsxs(N,{variant:"subtle",children:[e.jsxs(C,{children:[e.jsx(m,{className:"h-6 w-32"}),e.jsx(m,{className:"h-4 w-40 mt-2"})]}),e.jsx(y,{children:e.jsx("div",{className:"space-y-2",children:Array.from({length:3}).map((u,t)=>e.jsx(m,{className:"h-8 w-full rounded-md"},t))})})]})]})]})]});export{Ps as default};
