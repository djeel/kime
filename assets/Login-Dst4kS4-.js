const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Progress-DhOHsiPb.js","assets/index-iOXzGFVc.js","assets/index-CpzwNeZr.css","assets/useAsync-DH94AwA2.js","assets/progress-cy3bVhww.js","assets/ErrorState-CV5A9HrL.js","assets/stats-CgrdBu3t.js","assets/PageContainer-B4hCR2uv.js","assets/flame-C9UucE-H.js","assets/target-D7LytEqX.js","assets/trending-up-Cqu3r80X.js","assets/Workouts-DMiCJ4EY.js","assets/trash-2-D5Lj3B-0.js","assets/PageSkeletons-B1N6nasE.js","assets/pencil-1RFCJUh8.js","assets/Profile-BebfeGdM.js"])))=>i.map(i=>d[i]);
import{i as D,r,b as N,s as i,j as s,I as _,B as x,ag as c}from"./index-iOXzGFVc.js";import{L as k}from"./PageSkeletons-B1N6nasE.js";import{P as C}from"./PageContainer-B4hCR2uv.js";function A(){const f=D(),[o,w]=r.useState(""),[d,y]=r.useState(""),[p,u]=r.useState(!1),[b,v]=r.useState(!0),[g,n]=r.useState(null),{t:e}=N();r.useEffect(()=>{(async()=>{try{const{data:t}=await i.auth.getSession();if(t.session){f("/");return}}finally{v(!1)}})()},[]);const j=async t=>{t.preventDefault(),u(!0),n(null);const{data:l,error:a}=await i.auth.signInWithPassword({email:o,password:d});a?n(a.message):(async()=>{try{const m=l.user;if(c(()=>import("./Progress-DhOHsiPb.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10])),c(()=>import("./Workouts-DMiCJ4EY.js"),__vite__mapDeps([11,1,2,3,4,5,12,13,7,9,14])),c(()=>import("./Profile-BebfeGdM.js"),__vite__mapDeps([15,1,2,5,7,14,8])),m){const{fetchProgressData:P,fetchStreakOnly:S}=await c(async()=>{const{fetchProgressData:I,fetchStreakOnly:L}=await import("./stats-CgrdBu3t.js");return{fetchProgressData:I,fetchStreakOnly:L}},__vite__mapDeps([6,1,2])),h=i;P(h,m.id).catch(()=>{}),S(h,m.id).catch(()=>{})}}catch{}f("/")})(),u(!1)},E=async()=>{u(!0),n(null);const{data:t,error:l}=await i.auth.signUp({email:o,password:d});if(l)n(l.message);else{n(e("auth.signupConfirmNotice"));const a=t.user;a&&(await i.from("profiles").upsert({user_id:a.id,email:o}),await i.from("preferences").upsert({user_id:a.id}))}u(!1)};return b?s.jsx(k,{}):s.jsx(C,{title:e("auth.loginTitle"),className:"min-h-screen flex items-center justify-center p-4 min-w-0",autoFocus:!0,disableSkeleton:!0,children:s.jsxs("form",{onSubmit:j,className:"w-full max-w-sm space-y-3 border rounded-xl p-6 bg-card",children:[s.jsx("h1",{className:"text-xl font-bold",children:e("auth.loginTitle")}),s.jsx(_,{placeholder:e("auth.email"),"aria-label":e("auth.email"),type:"email",value:o,onChange:t=>w(t.target.value),required:!0}),s.jsx(_,{placeholder:e("auth.password"),"aria-label":e("auth.password"),type:"password",value:d,onChange:t=>y(t.target.value),required:!0}),s.jsx(x,{type:"submit",disabled:p,className:"w-full",children:e("auth.signIn")}),s.jsx(x,{type:"button",variant:"outline",onClick:E,disabled:p,className:"w-full",children:e("auth.signUp")}),g&&s.jsx("p",{className:"text-sm text-muted-foreground",children:g})]})})}export{A as default};
