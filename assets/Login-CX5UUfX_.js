const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Progress-DdxbAE67.js","assets/index-BfZ5KBQI.js","assets/index-DwtTbsig.css","assets/useAsync-CdrnrLkJ.js","assets/progress-CH9e0ym1.js","assets/ErrorState-CpDg7nxZ.js","assets/stats-CK7kMDFG.js","assets/PageContainer-Rz-u_6WB.js","assets/flame-C2ngVGDc.js","assets/target-C6opFIO2.js","assets/trending-up-BLEkHZQL.js","assets/Workouts-BTfQqr9H.js","assets/trash-2-B24cPI8D.js","assets/PageSkeletons-D1zAlwxf.js","assets/pencil-DUeMrmkB.js","assets/Profile-DPbD3ZD1.js","assets/award-W7YwAxjG.js"])))=>i.map(i=>d[i]);
import{i as D,r,b as N,s as i,j as s,I as _,B as x,ah as c}from"./index-BfZ5KBQI.js";import{L as k}from"./PageSkeletons-D1zAlwxf.js";import{P as C}from"./PageContainer-Rz-u_6WB.js";function A(){const f=D(),[o,w]=r.useState(""),[d,y]=r.useState(""),[p,u]=r.useState(!1),[b,v]=r.useState(!0),[h,n]=r.useState(null),{t:e}=N();r.useEffect(()=>{(async()=>{try{const{data:t}=await i.auth.getSession();if(t.session){f("/");return}}finally{v(!1)}})()},[]);const j=async t=>{t.preventDefault(),u(!0),n(null);const{data:l,error:a}=await i.auth.signInWithPassword({email:o,password:d});a?n(a.message):(async()=>{try{const m=l.user;if(c(()=>import("./Progress-DdxbAE67.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10])),c(()=>import("./Workouts-BTfQqr9H.js"),__vite__mapDeps([11,1,2,3,4,5,12,13,7,9,14])),c(()=>import("./Profile-DPbD3ZD1.js"),__vite__mapDeps([15,1,2,5,7,14,8,16])),m){const{fetchProgressData:P,fetchStreakOnly:S}=await c(async()=>{const{fetchProgressData:I,fetchStreakOnly:L}=await import("./stats-CK7kMDFG.js");return{fetchProgressData:I,fetchStreakOnly:L}},__vite__mapDeps([6,1,2])),g=i;P(g,m.id).catch(()=>{}),S(g,m.id).catch(()=>{})}}catch{}f("/")})(),u(!1)},E=async()=>{u(!0),n(null);const{data:t,error:l}=await i.auth.signUp({email:o,password:d});if(l)n(l.message);else{n(e("auth.signupConfirmNotice"));const a=t.user;a&&(await i.from("profiles").upsert({user_id:a.id,email:o}),await i.from("preferences").upsert({user_id:a.id}))}u(!1)};return b?s.jsx(k,{}):s.jsx(C,{title:e("auth.loginTitle"),className:"min-h-screen flex items-center justify-center p-4 min-w-0",autoFocus:!0,disableSkeleton:!0,children:s.jsxs("form",{onSubmit:j,className:"w-full max-w-sm space-y-3 border rounded-xl p-6 bg-card",children:[s.jsx("h1",{className:"text-xl font-bold",children:e("auth.loginTitle")}),s.jsx(_,{placeholder:e("auth.email"),"aria-label":e("auth.email"),type:"email",value:o,onChange:t=>w(t.target.value),required:!0}),s.jsx(_,{placeholder:e("auth.password"),"aria-label":e("auth.password"),type:"password",value:d,onChange:t=>y(t.target.value),required:!0}),s.jsx(x,{type:"submit",disabled:p,className:"w-full",children:e("auth.signIn")}),s.jsx(x,{type:"button",variant:"outline",onClick:E,disabled:p,className:"w-full",children:e("auth.signUp")}),h&&s.jsx("p",{className:"text-sm text-muted-foreground",children:h})]})})}export{A as default};
