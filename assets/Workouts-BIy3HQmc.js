import{g as J,b as ee,u as se,a as te,r as m,j as e,B as f,X as re,h as ae,s as S,i as ie,k as oe,C as A,c as G,d as F,f as U,e as H,I as ne}from"./index-mjEV0DEk.js";import{u as ce,B as V}from"./useAsync-DvM28CX_.js";import{P as Y}from"./progress-CG4DETrG.js";import{E as le}from"./ErrorState-0PO5aQxN.js";import{S as de,C as me,T as ue}from"./trash-2-D31ReXCF.js";import{W as xe}from"./PageSkeletons-B3tiHMcf.js";import{P as pe}from"./PageContainer-UeT_hR_D.js";import{T as Z,C as X}from"./target-DWCyUt4C.js";import{P as I}from"./pencil-D9Hqk-Ve.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=J("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=J("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=J("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=J("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),O=({onClose:B,day:l})=>{const{t:s}=ee(),{data:g,setData:$}=se(),{user:P}=te(),i=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"];i.map(a=>({key:a,label:s(`workouts.days.${a}`)}));const b=g.workoutsByDay||{monday:{name:s("workouts.monday.name"),duration:25,exercises:[{name:s("exercise.pushUps.description"),reps:"10-15",modification:s("exercise.pushUps.modification"),tips:s("exercise.pushUps.tips")},{name:s("exercise.plankHold.description"),reps:"30s",modification:s("exercise.plankHold.modification"),tips:s("exercise.plankHold.tips")},{name:s("exercise.tricepDips.description"),reps:"10",modification:s("exercise.tricepDips.modification"),tips:s("exercise.tricepDips.tips")}]},tuesday:{name:s("workouts.tuesday.name"),duration:20,exercises:[{name:s("exercise.deadBug.description"),reps:"12",modification:s("exercise.deadBug.modification"),tips:s("exercise.deadBug.tips")},{name:s("exercise.sidePlank.description"),reps:"20s each side",modification:s("exercise.sidePlank.modification"),tips:s("exercise.sidePlank.tips")},{name:s("exercise.mountainClimbers.description"),reps:"20",modification:s("exercise.mountainClimbers.modification"),tips:s("exercise.mountainClimbers.tips")}]},wednesday:{name:s("workouts.wednesday.name"),duration:30,exercises:[{name:s("exercise.squats.description"),reps:"15",modification:s("exercise.squats.modification"),tips:s("exercise.squats.tips")},{name:s("exercise.reverseLunges.description"),reps:"10 each leg",modification:s("exercise.reverseLunges.modification"),tips:s("exercise.reverseLunges.tips")},{name:s("exercise.gluteBridge.description"),reps:"15",modification:s("exercise.gluteBridge.modification"),tips:s("exercise.gluteBridge.tips")}]},thursday:{name:s("workouts.thursday.name"),duration:15,exercises:[{name:s("exercise.catCow.description"),reps:"10",modification:s("exercise.catCow.modification"),tips:s("exercise.catCow.tips")},{name:s("exercise.worldsGreatestStretch.description"),reps:"6 each side",modification:s("exercise.worldsGreatestStretch.modification"),tips:s("exercise.worldsGreatestStretch.tips")},{name:s("exercise.childsPose.description"),reps:"30s",modification:s("exercise.childsPose.modification"),tips:s("exercise.childsPose.tips")}]},friday:{name:s("workouts.friday.name"),duration:25,exercises:[{name:s("exercise.jumpingJacks.description"),reps:"30",modification:s("exercise.jumpingJacks.modification"),tips:s("exercise.jumpingJacks.tips")},{name:s("exercise.pushUps.description"),reps:"10",modification:s("exercise.pushUps.modification"),tips:s("exercise.pushUps.tips")},{name:s("exercise.squats.description"),reps:"15",modification:s("exercise.squats.modification"),tips:s("exercise.squats.tips")}]},saturday:{name:s("workouts.saturday.name"),duration:20,exercises:[{name:s("exercise.walking.description"),reps:"10 min",modification:s("exercise.walking.modification"),tips:s("exercise.walking.tips")},{name:s("exercise.standingQuadStretch.description"),reps:"30s each leg",modification:s("exercise.standingQuadStretch.modification"),tips:s("exercise.standingQuadStretch.tips")},{name:s("exercise.neckRolls.description"),reps:"10",modification:s("exercise.neckRolls.modification"),tips:s("exercise.neckRolls.tips")}]},sunday:{name:s("workouts.sunday.name"),duration:10,exercises:[{name:s("exercise.breathingPractice.description"),reps:"5 min",modification:s("exercise.breathingPractice.modification"),tips:s("exercise.breathingPractice.tips")},{name:s("exercise.bodyScan.description"),reps:"5 min",modification:s("exercise.bodyScan.modification"),tips:s("exercise.bodyScan.tips")}]}},[p,y]=m.useState(()=>{var a;return l?[{key:l,...b[l],exercises:(((a=b[l])==null?void 0:a.exercises)||[]).map(t=>({...t}))}]:i.map(t=>{var r;return{key:t,...b[t],exercises:(((r=b[t])==null?void 0:r.exercises)||[]).map(n=>({...n}))}})}),z=(a,t)=>{if(l)return;const r=[...p];t==="up"&&a>0&&([r[a-1],r[a]]=[r[a],r[a-1]]),t==="down"&&a<r.length-1&&([r[a],r[a+1]]=[r[a+1],r[a]]),y(r)},L=a=>{const t=[...p],r=t[a];r.rest=!r.rest,r.rest?(r._backupExercises=r.exercises,r.exercises=[],r.duration=0):(r.exercises=r._backupExercises||[],delete r._backupExercises),y(t)},j=a=>{const t=[...p],r=t[a].exercises[t[a].exercises.length-1];r&&!r.name&&!r.reps&&!r.modification&&!r.tips||(t[a].exercises.push({name:"",reps:"",modification:"",tips:""}),y(t))},R=(a,t)=>{const r=[...p];r[a].exercises.splice(t,1),y(r)},v=(a,t,r,n)=>{const d=[...p];d[a].exercises[t][r]=n,y(d)},M=(a,t,r)=>{const n=[...p];t==="duration"?n[a][t]=r===""?"":Number(r):n[a][t]=r,y(n)},h=async()=>{var a;if(l){const t=p[0];$({...g,workoutsByDay:{...g.workoutsByDay,[l]:{name:t.name,duration:t.duration,focus:t.focus,exercises:t.rest?[]:t.exercises}}})}else{const t={};p.forEach(r=>{t[r.key]={name:r.name,duration:r.duration,focus:r.focus,exercises:r.rest?[]:r.exercises}}),$({...g,workoutsByDay:t})}try{const t=P==null?void 0:P.id;if(!t)throw new Error("no-user");const r=p,n=r.filter(c=>!c.rest).map(c=>({user_id:t,day:c.key,name:c.name||"Session",duration:Number(c.duration)||0,focus:c.focus||null})),{data:d}=await S.from("workouts_by_day").select("day").eq("user_id",t),T=new Set((d||[]).map(c=>c.day)),o=new Set(n.map(c=>c.day)),w=Array.from(T).filter(c=>!o.has(c));w.length&&await S.from("workouts_by_day").delete().in("day",w).eq("user_id",t),n.length&&await S.from("workouts_by_day").upsert(n,{onConflict:"user_id,day"});const x=l?r.map(c=>c.key):i;await S.from("workout_exercises").delete().in("day",x).eq("user_id",t);const D=[];r.forEach(c=>{c.rest||c.exercises.forEach((_,q)=>{_.name&&D.push({user_id:t,day:c.key,order_int:q,name:_.name,reps:_.reps||null,modification:_.modification||null,tips:_.tips||null})})}),D.length&&await S.from("workout_exercises").insert(D);const k=((a=g==null?void 0:g.user)==null?void 0:a.username)||null;k&&ie(k)}catch(t){console.warn("Failed to persist routine",t)}B()},[N,Q]=m.useState(l?0:null),[u,E]=m.useState(null),C=(a,t)=>r=>{E({dayIdx:a,exIdx:t}),r.dataTransfer.effectAllowed="move"},K=(a,t)=>r=>{if(r.preventDefault(),!u||u.dayIdx!==a||u.exIdx===t)return;const n=[...p],d=n[a].exercises.slice(),[T]=d.splice(u.exIdx,1);d.splice(t,0,T),n[a].exercises=d,y(n),E({dayIdx:a,exIdx:t})},W=()=>E(null);return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-2 md:p-6",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:B}),e.jsxs("div",{className:`relative bg-card rounded-xl shadow-lg w-full ${l?"max-w-2xl":"max-w-5xl"} mx-auto flex flex-col overflow-hidden border border-border/60 animate-in`,style:{maxHeight:"92vh"},role:"dialog","aria-modal":"true","aria-label":s(l?`workouts.days.${l}`:"workouts.weeklyPlanning.title"),children:[e.jsxs("div",{className:"sticky top-0 bg-card/95 backdrop-blur-sm border-b px-5 py-4 flex items-center justify-between z-10",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-lg font-space-grotesk tracking-tight",children:s(l?`workouts.days.${l}`:"workouts.weeklyPlanning.title")}),l&&e.jsx("span",{className:"text-xs text-muted-foreground",children:s("workouts.editDaySubtitle","Adjust this session")})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(f,{variant:"outline",size:"sm",onClick:B,className:"gap-1",children:[e.jsx(re,{className:"w-4 h-4"}),s("common.cancel")]}),e.jsxs(f,{size:"sm",onClick:h,className:"gap-1",children:[e.jsx(de,{className:"w-4 h-4"}),s("common.save")]})]})]}),e.jsx("div",{className:"overflow-y-auto flex-1 px-4 py-4 md:px-8 md:py-6 space-y-6",children:e.jsx("div",{className:"flex flex-col gap-5",children:p.map((a,t)=>e.jsxs("div",{className:"flex flex-col w-full",children:[l?null:e.jsxs("button",{className:`flex items-center justify-between px-4 py-3 rounded-lg w-full text-left focus:outline-none transition-colors border ${N===t?"bg-muted/40 border-border":"bg-muted/10 border-transparent hover:bg-muted/20"}`,onClick:()=>Q(N===t?null:t),children:[e.jsxs("span",{className:"font-semibold text-base text-primary flex items-center gap-2",children:[s(`workouts.days.${a.key}`),e.jsx("span",{className:"text-xs text-muted-foreground font-normal",children:a.rest?s("workouts.restDay","Rest Day"):`${a.exercises.length} ex • ${a.duration||0}m`})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(f,{variant:"ghost",size:"icon",onClick:r=>{r.stopPropagation(),z(t,"up")},disabled:t===0,children:e.jsx(ge,{className:"w-4 h-4"})}),e.jsx(f,{variant:"ghost",size:"icon",onClick:r=>{r.stopPropagation(),z(t,"down")},disabled:t===p.length-1,children:e.jsx(fe,{className:"w-4 h-4"})}),N===t?e.jsx(me,{className:"ml-1 w-5 h-5 text-muted-foreground"}):e.jsx(ae,{className:"ml-1 w-5 h-5 text-muted-foreground"})]})]}),(l||N===t)&&e.jsxs("div",{className:"bg-background/60 rounded-xl p-5 flex flex-col gap-5 mt-3 border border-border/60",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:grid md:grid-cols-3",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-foreground",children:s("workouts.nameLabel","Session name")}),e.jsx("input",{className:"w-full rounded-md border border-border bg-background px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/40 transition",value:a.name,onChange:r=>M(t,"name",r.target.value),placeholder:s(`workouts.${a.key}.name`,"Nom du jour"),disabled:!!l})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-foreground",children:s("workouts.focusLabel","Focus")}),e.jsx("input",{className:"w-full rounded-md border border-border bg-background px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/40 transition",value:a.focus,onChange:r=>M(t,"focus",r.target.value),placeholder:s(`workouts.${a.key}.focus`,"Focus du jour")})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-foreground",children:s("workouts.durationLabel","Duration (min)")}),e.jsx("input",{className:"w-full rounded-md border border-border bg-background px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/40 transition",type:"number",value:a.duration||"",onChange:r=>M(t,"duration",r.target.value),placeholder:s("workouts.minutes","Durée")})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{type:"button",onClick:()=>L(t),className:`text-xs px-2.5 py-1 rounded-full border transition ${a.rest?"bg-muted/60 border-border text-muted-foreground":"bg-primary/10 border-primary/30 text-primary"}`,children:a.rest?s("workouts.toggleRestOff","Rest day"):s("workouts.toggleRestOn","Active day")}),e.jsx("span",{className:"text-xs text-muted-foreground",children:a.rest?s("workouts.restDayDescription","This day will be a recovery / rest day."):s("workouts.activeDayDescription","Configure exercises below.")})]}),e.jsx("div",{children:!a.rest&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-semibold mb-2 text-sm tracking-wide uppercase text-muted-foreground/80",children:s("workouts.exercises","Exercices")}),e.jsx("div",{className:"flex flex-col gap-3",children:a.exercises.map((r,n)=>e.jsxs("div",{className:`flex flex-col md:flex-row gap-3 bg-muted/10 rounded-md p-3 pl-8 border border-border/40 group relative ${u&&u.dayIdx===t&&u.exIdx===n?"opacity-70 ring-1 ring-primary/50":""}`,draggable:!0,onDragStart:C(t,n),onDragOver:K(t,n),onDragEnd:W,children:[e.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-muted-foreground/60 group-hover:text-foreground transition cursor-grab active:cursor-grabbing select-none","aria-hidden":"true",children:e.jsx(he,{className:"w-4 h-4"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 flex-1",children:[e.jsx("div",{className:"flex flex-col gap-1 min-w-0",children:e.jsx("input",{className:"w-full rounded-md border border-border bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/40",value:r.name,onChange:d=>v(t,n,"name",d.target.value),placeholder:s("workouts.exerciseNameLabel","Nom de l'exercice")})}),e.jsx("div",{className:"flex flex-col gap-1 min-w-0",children:e.jsx("input",{className:"w-full rounded-md border border-border bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/40",value:r.reps,onChange:d=>v(t,n,"reps",d.target.value),placeholder:s("workouts.repsLabel","Répétitions")})}),e.jsx("div",{className:"flex flex-col gap-1 min-w-0",children:e.jsx("input",{className:"w-full rounded-md border border-border bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/40",value:r.modification,onChange:d=>v(t,n,"modification",d.target.value),placeholder:s("workouts.modificationLabel","Modification")})}),e.jsx("div",{className:"flex flex-col gap-1 min-w-0",children:e.jsx("input",{className:"w-full rounded-md border border-border bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/40",value:r.tips,onChange:d=>v(t,n,"tips",d.target.value),placeholder:s("workouts.tipsLabel","Conseils")})})]}),e.jsx("div",{className:"flex items-center gap-1 self-start md:self-stretch md:flex-col",children:e.jsx(f,{variant:"ghost",size:"icon",onClick:()=>R(t,n),"aria-label":s("common.delete","Supprimer"),className:"hover:bg-red-500/10",children:e.jsx(ue,{className:"w-4 h-4 text-red-500"})})})]},n))}),e.jsxs(f,{variant:"outline",size:"sm",className:"mt-3 w-full",onClick:()=>j(t),children:[e.jsx(we,{className:"w-4 h-4 mr-1"})," ",s("workouts.addExerciseButton","Ajouter un exercice")]})]})})]})]},a.key))})})]})]})},Pe=()=>{const[B,l]=m.useState(!1),[s,g]=m.useState(!1),[$,P]=m.useState(null),{t:i}=ee(),{data:b,setData:p}=se(),y=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],z=y.map(o=>({key:o,label:i(`workouts.days.${o}`)})),L=b.workoutsByDay,[j,R]=m.useState(y[new Date().getDay()-1]||"monday"),v=L[j];m.useState(!1),m.useState(0),m.useState([]),m.useState(0),m.useState(!1),m.useRef(null);const M=oe(),{user:h}=te(),[N,Q]=m.useState([]),[u,E]=m.useState(b.weeklyProgress.workoutsTarget||3),[C,K]=m.useState(b.weeklyProgress.workoutsCompleted||0),[W,a]=m.useState(!1),[t,r]=m.useState(String(b.weeklyProgress.workoutsTarget||3)),{loading:n,error:d,run:T}=ce(async()=>{if(!h)return;const{data:o}=await S.from("preferences").select("weekly_goal").eq("user_id",h.id).maybeSingle();o!=null&&o.weekly_goal&&E(o.weekly_goal);const{data:w}=await S.from("workout_sessions").select("started_at, finished_at, duration_min, completed").eq("user_id",h.id).order("started_at",{ascending:!1}).limit(5);Q((w||[]).map(q=>({name:i("workouts.session"),date:new Date(q.started_at).toLocaleDateString(),duration:q.duration_min||0,completed:!!q.completed})));const x=new Date,D=x.getDay(),k=(D===0?-6:1)-D,c=new Date(x.getFullYear(),x.getMonth(),x.getDate()+k),{count:_}=await S.from("workout_sessions").select("*",{count:"exact",head:!0}).eq("user_id",h.id).eq("completed",!0).gte("started_at",c.toISOString());K(_||0)},{deps:[h==null?void 0:h.id]});return n?e.jsx(xe,{}):d?e.jsx(le,{title:i("common.error","Error"),message:String((d==null?void 0:d.message)||d),retryLabel:i("common.retry","Retry"),onRetry:T}):e.jsxs(pe,{title:i("workouts.title"),className:"space-y-8 min-w-0 overflow-x-hidden stagger-children",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight font-space-grotesk",children:i("workouts.title")}),e.jsx("p",{className:"text-muted-foreground",children:i("workouts.subtitle")})]}),e.jsxs("div",{className:"grid gap-6",children:[e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 snap-x stagger-children",children:z.map(({key:o,label:w})=>e.jsx(f,{variant:j===o?"default":"outline",size:"sm",className:"min-w-[100px] snap-start transition-colors ring-0 focus:ring-0 focus-visible:ring-0 focus:outline-none focus-visible:outline-none focus:ring-offset-0 focus-visible:ring-offset-0",onClick:()=>R(o),children:w},o))}),e.jsxs(A,{variant:"tint",children:[e.jsxs(G,{children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Z,{className:"h-6 w-6 text-primary"}),e.jsxs(F,{size:"xl",children:[i(`workouts.${j}.name`)," ",i("workouts.session")]})]})}),e.jsx(U,{className:"text-base",children:i(`workouts.${j}.focus`,v.focus)})]}),e.jsxs(H,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-2xl font-bold text-primary",children:i(`workouts.${j}.name`,v.name)}),e.jsxs("span",{className:"text-muted-foreground",children:[v.duration," ",i("workouts.minutes")]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(f,{className:"w-full btn-primary-premium",onClick:()=>M("/exercise",{state:{workout:v,selectedDay:j}}),children:i("workouts.startSession")})})]})]}),e.jsxs(A,{variant:"subtle",children:[e.jsxs(G,{children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-6 w-6 text-primary"}),e.jsx(F,{size:"xl",children:i("workouts.weeklyPlanning.title")})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(f,{variant:"outline",size:"sm",onClick:()=>g(!0),"aria-label":i("workouts.weeklyPlanning.editFullPlan","Edit full plan"),children:[e.jsx(I,{className:"h-4 w-4 mr-1"})," ",i("workouts.weeklyPlanning.editButton")]})})]}),e.jsx(U,{className:"text-base mt-2 max-w-2xl",children:i("workouts.weeklyPlanning.description")})]}),e.jsx(H,{className:"pt-2 pb-4",children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:z.map(({key:o,label:w})=>{const x=L[o],D=j===o,k=!x;return e.jsxs("button",{type:"button",onClick:()=>R(o),onKeyDown:c=>{(c.key==="Enter"||c.key===" ")&&(c.preventDefault(),R(o))},"aria-pressed":D,"aria-label":i("workouts.weeklyPlanning.dayAriaLabel",{defaultValue:`${w} – ${k?i("workouts.restDay","Rest Day"):i(`workouts.${o}.name`,x.name)}`}),className:["group relative text-left rounded-lg border p-3 flex flex-col gap-1 w-full overflow-hidden transition-colors duration-150","focus:outline-none focus-visible:outline-none ring-0 focus:ring-0 focus-visible:ring-0 focus:ring-offset-0 focus-visible:ring-offset-0",D?"border-border bg-primary/5 shadow-sm":"border-border bg-background hover:bg-muted/40 active:bg-muted/50","min-h-[132px]"].join(" "),style:{wordBreak:"break-word"},children:[e.jsx("div",{className:"flex items-start justify-between mb-0.5",children:e.jsx("span",{className:"font-semibold text-sm text-primary leading-tight truncate pr-2",children:w})}),e.jsx("div",{className:"font-medium text-sm text-foreground truncate",children:k?i("workouts.restDay","Rest Day"):i(`workouts.${o}.name`,x.name)}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[!k&&e.jsx(X,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:k?i("workouts.noDuration","-"):`${x.duration} ${i("workouts.minShort","min")}`})]}),e.jsx("div",{className:"text-[11px] italic text-muted-foreground truncate",children:!k&&i(`workouts.${o}.focus`,x.focus)}),e.jsx("div",{className:"mt-auto pt-1 flex justify-end",children:e.jsxs(f,{variant:"ghost",size:"sm",className:"h-7 px-2 text-xs opacity-0 group-hover:opacity-100 transition-opacity",onClick:c=>{c.stopPropagation(),P(o)},"aria-label":i("workouts.weeklyPlanning.editDayButton"),children:[e.jsx(I,{className:"h-3.5 w-3.5 mr-1"})," ",i("common.edit","Edit")]})})]},o)})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(A,{variant:"subtle",children:[e.jsxs(G,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-5 w-5 text-primary"}),e.jsx(F,{size:"base",children:i("workouts.recentSessions")})]}),N.length>0&&e.jsx(V,{variant:"outline",className:"text-[10px] font-normal px-2 py-0.5",children:N.length})]}),e.jsx(U,{className:"text-xs",children:i("workouts.recentSessionsDescription")})]}),e.jsx(H,{className:"pt-0 space-y-3",children:N.length>0?e.jsx("div",{className:"space-y-2 stagger-children",children:N.map((o,w)=>{const x=o.duration?Math.min(100,Math.round(o.duration/60*100)):0;return e.jsxs("div",{className:"group rounded-md border border-border/40 p-3 hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:o.name}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsxs("span",{className:"text-xs text-muted-foreground",children:[o.duration," ",i("workouts.minutes")]}),o.completed&&e.jsx(V,{variant:"secondary",className:"text-[10px] bg-green-500/15 text-green-600",children:i("workouts.completed")})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[e.jsx("span",{className:"text-[10px] text-muted-foreground",children:o.date}),o.duration>0&&e.jsxs("span",{className:"text-[10px] text-muted-foreground",children:[x,"%"]})]}),o.duration>0&&e.jsx(Y,{value:x,className:"h-1 mt-2"})]},w)})}):e.jsx("p",{className:"text-sm text-muted-foreground",children:i("workouts.noRecentSessions")})})]}),e.jsxs(A,{variant:"subtle",children:[e.jsxs(G,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-5 w-5 text-primary"}),e.jsx(F,{size:"base",children:i("workouts.weeklyGoal")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{variant:"outline",className:"text-[10px] font-normal px-2 py-0.5",children:u||0}),e.jsx(f,{variant:"outline",size:"sm",onClick:()=>{a(o=>!o),r(String(u))},children:W?i("common.cancel","Cancel"):i("common.edit","Edit")})]})]}),e.jsx(U,{className:"text-xs",children:i("workouts.weeklyGoalDescription")})]}),e.jsxs(H,{className:"pt-0 space-y-4",children:[e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-4xl font-bold leading-none text-primary","aria-label":`${C} / ${u}`,children:C}),e.jsx("div",{className:"mt-1 text-xs text-muted-foreground uppercase tracking-wide",children:i("workouts.completedThisWeek")})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-[10px] uppercase tracking-wide text-muted-foreground",children:i("workouts.weeklyGoal")}),e.jsxs("div",{className:"mt-1 flex items-baseline justify-end gap-1",children:[e.jsx("span",{className:"text-lg font-semibold",children:C}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["/ ",u]})]}),e.jsxs(V,{variant:"secondary",className:"mt-2 text-[10px]",children:[Math.min(100,u?Math.round(C/u*100):0),"%"]})]})]}),e.jsx(Y,{value:Math.min(100,u?Math.round(C/u*100):0),className:"h-2"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[Math.max(0,u-C)," ",i("workouts.moreSessions")," ",i("workouts.toReachGoal")]}),W&&e.jsxs("div",{className:"flex items-center gap-2 pt-1",children:[e.jsx(ne,{type:"number",min:1,max:14,value:t,onChange:o=>r(o.target.value),className:"w-24 h-8"}),e.jsx(f,{size:"sm",onClick:async()=>{const o=Math.max(1,Math.min(14,Number(t)||1));E(o),h&&await S.from("preferences").upsert({user_id:h.id,weekly_goal:o}),a(!1)},children:i("common.save","Save")})]})]})]})]})]}),B&&e.jsx("div",{className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center",onClick:()=>l(!1),children:e.jsxs("div",{className:"bg-card rounded-lg shadow-xl p-6 max-w-2xl w-full",onClick:o=>o.stopPropagation(),children:[e.jsx("div",{className:"text-lg font-bold mb-2",children:i("exerciseBuilder.title","Créer un exercice")}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx(f,{variant:"outline",onClick:()=>l(!1),children:i("common.cancel","Cancel")})})]})}),s&&e.jsx("div",{className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center",onClick:()=>g(!1),children:e.jsx("div",{className:"bg-card rounded-lg shadow-xl p-6 max-w-2xl w-full",onClick:o=>o.stopPropagation(),children:e.jsx(O,{onClose:()=>g(!1)})})}),$&&e.jsx("div",{className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center",onClick:()=>P(null),children:e.jsx("div",{className:"bg-card rounded-lg shadow-xl p-6 max-w-lg w-full",onClick:o=>o.stopPropagation(),children:e.jsx(O,{day:$,onClose:()=>P(null)})})})]})};export{Pe as default};
