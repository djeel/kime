import{g as X,r as n,j as e,O as Ee,l as F,m as Te,n as rs,X as T,T as Fe,D as Oe,R as ns,o as ls,p as ds,a as cs,i as os,q as ms,b as us,s as c,t as xs,C as N,e as y,v as $,w as A,x as E,B as x,y as Le,c as C,d as ae,f as ie,I,S as o,z as ze}from"./index-BfZ5KBQI.js";import{E as fs}from"./ErrorState-CpDg7nxZ.js";import{P as hs}from"./PageContainer-Rz-u_6WB.js";import{P as ps}from"./pencil-DUeMrmkB.js";import{F as gs}from"./flame-C2ngVGDc.js";import{A as $e}from"./award-W7YwAxjG.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const js=X("CalendarRange",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M17 14h-6",key:"bkmgh3"}],["path",{d:"M13 18H7",key:"bb0bb7"}],["path",{d:"M7 14h.01",key:"1qa3f1"}],["path",{d:"M17 18h.01",key:"1bdyru"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vs=X("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=X("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ys=X("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Ae=ns,_s=ls,Ue=n.forwardRef(({className:m,...i},f)=>e.jsx(Ee,{ref:f,className:F("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",m),...i}));Ue.displayName=Ee.displayName;const re=n.forwardRef(({className:m,children:i,...f},h)=>e.jsxs(_s,{children:[e.jsx(Ue,{}),e.jsxs(Te,{ref:h,className:F("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",m),...f,children:[i,e.jsxs(rs,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(T,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));re.displayName=Te.displayName;const ne=({className:m,...i})=>e.jsx("div",{className:F("flex flex-col space-y-1.5 text-center sm:text-left",m),...i});ne.displayName="DialogHeader";const le=n.forwardRef(({className:m,...i},f)=>e.jsx(Fe,{ref:f,className:F("text-lg font-semibold leading-none tracking-tight",m),...i}));le.displayName=Fe.displayName;const de=n.forwardRef(({className:m,...i},f)=>e.jsx(Oe,{ref:f,className:F("text-sm text-muted-foreground",m),...i}));de.displayName=Oe.displayName;const te=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],Ds=()=>{var qe,De;const{username:m}=ds(),{user:i}=cs(),f=os(),{toast:h}=ms(),{t}=us(),[Me,R]=n.useState(!0),[Be,Y]=n.useState(!1),[He,J]=n.useState(!1),[a,O]=n.useState(null),[ce,Ie]=n.useState({showAchievements:!0,showRoutine:!0}),[_,Xe]=n.useState(null),[oe,Ye]=n.useState([]),[V,Je]=n.useState({count:0,minutes:0,xp:0}),[Ve,Ge]=n.useState([]),[me,G]=n.useState(0),[ue,K]=n.useState([]),[xe,fe]=n.useState([]),[Q,he]=n.useState([]),[Ke,U]=n.useState(!1),[q,pe]=n.useState(""),[ge,je]=n.useState(!1),[ve,W]=n.useState(0),[D,j]=n.useState("none"),[Qe,M]=n.useState(!1),[Z,Ne]=n.useState(""),[ee,ye]=n.useState(""),[w,_e]=n.useState(""),[P,L]=n.useState("idle"),z=n.useRef(null),[se,B]=n.useState(null),[S,H]=n.useState(void 0),we=n.useRef(null),[We,Se]=n.useState(!1);n.useEffect(()=>{(async()=>{var d;let s=m;if(!s&&i){const{data:u}=await c.from("profiles").select("username").eq("user_id",i.id).maybeSingle();s=(u==null?void 0:u.username)||void 0}if(!s&&!i){R(!1),f("/login",{replace:!0,state:{from:"/profile"}});return}if(!s){J(!0),R(!1);return}a&&((d=a.username)==null?void 0:d.toLowerCase())===s.toLowerCase()?Y(!0):(R(!0),J(!1));const l=await xs(c,s);if(!l.profile){J(!0),R(!1),Y(!1);return}O(l.profile),l.profile.profile_layout&&Ie(l.profile.profile_layout),Xe(l.streak),Ye(l.badges),Je(l.sessions),Ge((l.routine||[]).slice().sort((u,v)=>te.indexOf(u.day)-te.indexOf(v.day))),await be(l.profile.user_id),R(!1),Y(!1)})()},[m]),n.useEffect(()=>{(async()=>!i||!a||(await Ze(i.id,a.user_id),i.id===a.user_id&&await b(i.id)))()},[i==null?void 0:i.id,a==null?void 0:a.user_id]);async function be(s){const{data:r}=await c.from("friendships").select("user_id,friend_user_id,status").eq("status","accepted").or(`user_id.eq.${s},friend_user_id.eq.${s}`),l=new Set;if((r||[]).forEach(d=>l.add(d.user_id===s?d.friend_user_id:d.user_id)),l.size){const{data:d}=await c.from("profiles").select("user_id,name,avatar_url,username").in("user_id",Array.from(l));G(l.size),K(d||[])}else G(0),K([])}async function Ze(s,r){if(s===r){j("friends");return}const{data:l}=await c.from("friendships").select("status,user_id,friend_user_id").or(`and(user_id.eq.${s},friend_user_id.eq.${r}),and(user_id.eq.${r},friend_user_id.eq.${s})`).limit(1);if(!l||!l.length){j("none");return}const d=l[0];if(d.status==="accepted"){j("friends");return}if(d.status==="pending"){d.user_id===s?j("pending-out"):j("pending-in");return}j("none")}async function b(s){const[{data:r},{data:l}]=await Promise.all([c.from("friendships").select("user_id,friend_user_id,created_at").eq("friend_user_id",s).eq("status","pending"),c.from("friendships").select("user_id,friend_user_id,created_at").eq("user_id",s).eq("status","pending")]),d=(r||[]).map(g=>g.user_id),u=(l||[]).map(g=>g.friend_user_id),v=[...d,...u];if(v.length){const{data:g}=await c.from("profiles").select("user_id,name,avatar_url,username").in("user_id",v),Pe=Object.fromEntries((g||[]).map(k=>[k.user_id,k]));fe(d.map(k=>Pe[k]).filter(Boolean)),he(u.map(k=>Pe[k]).filter(Boolean))}else fe([]),he([])}n.useEffect(()=>{if(!a||!i||i.id!==a.user_id)return;const s=l=>{var d,u;if(l.key==="kime-app-data")try{const v=(u=(d=JSON.parse(l.newValue||"{}"))==null?void 0:d.user)==null?void 0:u.avatar_url;v&&v!==a.avatar_url&&(O(g=>({...g,avatar_url:v})),W(Date.now()))}catch{}};window.addEventListener("storage",s);const r=l=>{const d=l.detail;(d==null?void 0:d.userId)===a.user_id&&(O(u=>({...u,avatar_url:d.avatar_url})),W(Date.now()))};return window.addEventListener("kime:avatar-updated",r),()=>{window.removeEventListener("storage",s),window.removeEventListener("kime:avatar-updated",r)}},[a==null?void 0:a.user_id,a==null?void 0:a.avatar_url,i==null?void 0:i.id]);const p=n.useMemo(()=>i&&a&&i.id===a.user_id,[i==null?void 0:i.id,a==null?void 0:a.user_id]),es=async()=>{!i||!a||p||D!=="none"||(je(!0),await c.from("friendships").upsert({user_id:i.id,friend_user_id:a.user_id,status:"pending"}),j("pending-out"),je(!1),h({description:t("profileSocial.friendRequestSent")}))},ss=async()=>{if(!i||!q.trim())return;const s=q.replace(/^@/,"").toLowerCase(),{data:r}=await c.from("profiles").select("user_id,username").or(`username.eq.${s},email.eq.${q}`).maybeSingle();if(!(r!=null&&r.user_id)){h({description:t("profileSocial.userNotFound")});return}if(r.user_id===i.id){h({description:t("profileSocial.cannotAddSelf")});return}await c.from("friendships").upsert({user_id:i.id,friend_user_id:r.user_id,status:"pending"}),h({description:t("profileSocial.friendRequestSent")}),pe(""),await b(i.id)},ke=async s=>{i&&(await c.from("friendships").delete().or(`and(user_id.eq.${i.id},friend_user_id.eq.${s}),and(user_id.eq.${s},friend_user_id.eq.${i.id})`),K(r=>r.filter(l=>l.user_id!==s)),G(r=>Math.max(0,r-1)),a!=null&&a.username&&ze(a.username),s===(a==null?void 0:a.user_id)&&j("none"),await b(i.id))},Ce=async s=>{i&&(await c.from("friendships").update({status:"accepted"}).match({user_id:s,friend_user_id:i.id}),await Promise.all([be(i.id),b(i.id)]),(a==null?void 0:a.user_id)===s&&j("friends"))},Re=async s=>{i&&(await c.from("friendships").delete().match({user_id:s,friend_user_id:i.id}),await b(i.id),(a==null?void 0:a.user_id)===s&&j("none"))},as=async s=>{i&&(await c.from("friendships").delete().match({user_id:i.id,friend_user_id:s}),await b(i.id),(a==null?void 0:a.user_id)===s&&j("none"))},is=async()=>{if(!i||!p)return;let s=w.trim().toLowerCase();if(s&&s!==a.username){if(P==="taken"||P==="checking"){h({description:t("profileSocial.usernameIsTaken")});return}}else s=a.username;const r={user_id:i.id,name:Z||null,bio:ee||null,username:s};if(S&&se)try{const d=se.name.split(".").pop()||"jpg",u=`${i.id}-${Date.now()}.${d}`,{error:v}=await c.storage.from("avatars").upload(u,se,{upsert:!0});if(v)throw v;const{data:g}=c.storage.from("avatars").getPublicUrl(u);g!=null&&g.publicUrl&&(r.avatar_url=g.publicUrl)}catch{h({description:t("profileSocial.profilePhotoUpdateError")})}const{error:l}=await c.from("profiles").upsert(r);l?h({description:l.message}):(O(d=>({...d,name:Z,bio:ee,username:s,avatar_url:r.avatar_url||d.avatar_url})),a!=null&&a.username&&ze(a.username),r.avatar_url&&window.dispatchEvent(new CustomEvent("kime:avatar-updated",{detail:{userId:i.id,avatar_url:r.avatar_url}})),h({description:t("profileSocial.profileSynced")}),M(!1),B(null),H(void 0),W(Date.now()))},ts=async()=>{try{await navigator.clipboard.writeText(window.location.href),Se(!0),setTimeout(()=>Se(!1),1500),h({description:t("profileSocial.profileLinkCopied")})}catch{}};return n.useEffect(()=>{if(p){if(z.current&&clearTimeout(z.current),!w.trim()||w.trim().toLowerCase()===(a==null?void 0:a.username)){L("idle");return}return L("checking"),z.current=setTimeout(async()=>{const s=w.trim().toLowerCase(),{data:r}=await c.from("profiles").select("user_id").eq("username",s).maybeSingle();!r||r.user_id===(i==null?void 0:i.id)?L("available"):L("taken")},400),()=>{z.current&&clearTimeout(z.current)}}},[w,p,a==null?void 0:a.username,i==null?void 0:i.id]),n.useEffect(()=>()=>{S&&URL.revokeObjectURL(S)},[S]),Me?e.jsx(ws,{}):He||!a?e.jsx(fs,{title:t("profileSocial.userNotFoundSimple"),message:t("profileSocial.profileNotExist"),retryLabel:t("common.retry","Retry"),onRetry:()=>window.location.reload()}):e.jsxs(hs,{title:(a==null?void 0:a.name)||t("profileSocial.profile","Profile"),className:"space-y-8 min-w-0 stagger-children",busy:Be,children:[e.jsx(N,{variant:"subtle",children:e.jsxs(y,{className:"pt-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start gap-4",children:[e.jsxs($,{className:"h-20 w-20",children:[e.jsx(A,{src:a.avatar_url?`${a.avatar_url}${a.avatar_url.includes("?")?"&":"?"}v=${ve}`:void 0}),e.jsx(E,{children:((qe=a.name)==null?void 0:qe.slice(0,1))||"U"})]}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight font-space-grotesk truncate",children:a.name||t("profileSocial.noName")}),e.jsxs("span",{className:"text-sm text-muted-foreground truncate",children:["@",a.username]})]}),a.bio&&e.jsx("p",{className:"text-sm mt-2 max-w-prose leading-relaxed",children:a.bio}),e.jsxs("div",{className:"flex items-center gap-6 text-sm mt-3",children:[e.jsxs("button",{type:"button",className:"hover:underline",onClick:()=>U(!0),children:[e.jsx("strong",{children:me})," ",t("profileSocial.friends")]}),e.jsxs("span",{className:"hidden md:inline text-muted-foreground",children:[t("profileSocial.joined")," ",new Date(a.created_at).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 self-start",children:[p&&e.jsxs(x,{size:"sm",variant:"outline",onClick:()=>{Ne(a.name||""),ye(a.bio||""),_e(a.username||""),L("idle"),B(null),H(void 0),M(!0)},children:[e.jsx(ps,{className:"h-4 w-4 mr-1"})," ",t("profileSocial.editProfileShort")]}),!p&&D==="none"&&e.jsx(x,{size:"sm",onClick:es,disabled:ge,children:ge?"...":t("profileSocial.addFriend")}),!p&&D==="pending-out"&&e.jsx(x,{size:"sm",variant:"outline",disabled:!0,children:t("profileSocial.requested")}),!p&&D==="pending-in"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(x,{size:"sm",onClick:()=>Ce(a.user_id),variant:"default",children:[e.jsx(Le,{className:"h-4 w-4 mr-1"}),t("profileSocial.accept")]}),e.jsxs(x,{size:"sm",variant:"outline",onClick:()=>Re(a.user_id),children:[e.jsx(T,{className:"h-4 w-4 mr-1"}),t("profileSocial.decline")]})]}),!p&&D==="friends"&&e.jsx(x,{size:"sm",variant:"outline",onClick:()=>ke(a.user_id),children:t("profileSocial.unfriend")}),e.jsxs(x,{size:"sm",variant:"outline",onClick:ts,children:[e.jsx(vs,{className:"h-4 w-4 mr-1"})," ",t(We?"profileSocial.copied":"profileSocial.share")]})]})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-2 md:grid-cols-5 gap-3 text-sm",children:[e.jsxs("div",{className:"rounded-md bg-muted/30 p-3",children:[e.jsx("div",{className:"text-muted-foreground",children:t("profileSocial.sessionsLabel")||"Sessions"}),e.jsx("div",{className:"font-medium text-lg",children:V.count})]}),e.jsxs("div",{className:"rounded-md bg-muted/30 p-3",children:[e.jsx("div",{className:"text-muted-foreground",children:t("profileSocial.minutesLabel")||"Minutes"}),e.jsx("div",{className:"font-medium text-lg",children:V.minutes})]}),e.jsxs("div",{className:"rounded-md bg-muted/30 p-3",children:[e.jsx("div",{className:"text-muted-foreground",children:t("profileSocial.xpLabel")||"XP"}),e.jsx("div",{className:"font-medium text-lg",children:V.xp})]}),e.jsxs("div",{className:"rounded-md bg-muted/30 p-3",children:[e.jsxs("div",{className:"text-muted-foreground flex items-center gap-1",children:[e.jsx(gs,{className:"h-3 w-3"})," ",t("profileSocial.currentStreakShort")||"Current streak"]}),e.jsx("div",{className:"font-medium text-lg",children:(_==null?void 0:_.current_streak)||0})]}),e.jsxs("div",{className:"rounded-md bg-muted/30 p-3",children:[e.jsx("div",{className:"text-muted-foreground",children:t("profileSocial.bestStreakShort")||"Best streak"}),e.jsx("div",{className:"font-medium text-lg",children:(_==null?void 0:_.best_streak)||0})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[e.jsx("div",{className:"lg:col-span-7 space-y-6",children:ce.showAchievements!==!1&&e.jsxs(N,{variant:"subtle",children:[e.jsxs(C,{children:[e.jsxs(ae,{size:"lg",className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-5 w-5 text-primary"})," ",t("profileSocial.achievementsTitle")]}),e.jsx(ie,{children:t("profileSocial.achievementsDesc")})]}),e.jsx(y,{children:oe.length?e.jsx("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-3",children:oe.map(s=>e.jsxs("div",{className:"rounded-md bg-muted/30 p-3 text-sm flex items-center gap-3",children:[e.jsx($e,{className:"h-4 w-4 text-primary"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:s.name||"Achievement"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(s.created_at).toLocaleDateString()})]})]},s.id))}):e.jsx("p",{className:"text-sm text-muted-foreground mt-4",children:t("profileSocial.noAchievementsYet")})})]})}),e.jsxs("div",{className:"lg:col-span-5 space-y-6",children:[ce.showRoutine!==!1&&e.jsxs(N,{variant:"subtle",children:[e.jsxs(C,{children:[e.jsxs(ae,{size:"lg",className:"flex items-center gap-2",children:[e.jsx(js,{className:"h-5 w-5 text-primary"})," ",t("profileSocial.weeklyRoutineTitle")]}),e.jsx(ie,{children:t("profileSocial.weeklyRoutineDesc")})]}),e.jsx(y,{children:e.jsx("div",{className:"rounded-md border divide-y text-sm",children:te.map(s=>{const r=Ve.find(d=>d.day===s),l=!r;return e.jsxs("div",{className:`flex items-center justify-between p-3 ${l?"":"bg-muted/20"}`,children:[e.jsx("div",{className:"text-muted-foreground capitalize min-w-[90px]",children:s}),r?e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium truncate",children:r.name}),e.jsxs("div",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[e.jsx(Ns,{className:"h-3 w-3"})," ",r.duration," min",r.focus?` â€¢ ${r.focus}`:""]})]}):e.jsx("div",{className:"text-xs text-muted-foreground",children:t("profileSocial.restDay")})]},s)})})})]}),e.jsxs(N,{variant:"subtle",children:[e.jsxs(C,{children:[e.jsxs(ae,{size:"lg",className:"flex items-center gap-2",children:[e.jsx(ys,{className:"h-5 w-5 text-primary"})," ",t("profileSocial.socialTitle")]}),e.jsx(ie,{children:t("profileSocial.socialDesc")})]}),e.jsxs(y,{className:"space-y-4",children:[p&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{placeholder:t("profileSocial.findFriendsPlaceholder"),value:q,onChange:s=>pe(s.target.value)}),e.jsx(x,{size:"sm",onClick:ss,disabled:!q.trim(),children:t("profileSocial.add")})]}),e.jsxs("div",{className:"flex flex-col gap-4 text-sm",children:[e.jsx("div",{className:"flex items-center gap-6",children:e.jsxs("button",{type:"button",className:"hover:underline",onClick:()=>U(!0),children:[e.jsx("strong",{children:me})," ",t("profileSocial.friends")]})}),p&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"font-medium",children:t("profileSocial.requests")}),e.jsxs("div",{className:"space-y-2",children:[xe.map(s=>{var r;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>f(`/profile/${s.username||s.user_id}`),className:"flex items-center gap-2 flex-1 text-left hover:underline",children:[e.jsxs($,{className:"h-8 w-8",children:[e.jsx(A,{src:s.avatar_url||void 0}),e.jsx(E,{children:((r=s.name)==null?void 0:r.slice(0,1))||"?"})]}),e.jsx("span",{className:"truncate",children:s.name||"User"})]}),e.jsx(x,{size:"icon",variant:"secondary",onClick:()=>Ce(s.user_id),"aria-label":t("profileSocial.accept"),children:e.jsx(Le,{className:"h-4 w-4"})}),e.jsx(x,{size:"icon",variant:"ghost",onClick:()=>Re(s.user_id),"aria-label":t("profileSocial.decline"),children:e.jsx(T,{className:"h-4 w-4"})})]},s.user_id)}),xe.length===0&&e.jsx("p",{className:"text-xs text-muted-foreground",children:t("profileSocial.noPending")})]}),Q.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"font-medium",children:t("profileSocial.pendingCount",{count:Q.length})}),Q.map(s=>{var r;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>f(`/profile/${s.username||s.user_id}`),className:"flex items-center gap-2 flex-1 text-left hover:underline",children:[e.jsxs($,{className:"h-8 w-8",children:[e.jsx(A,{src:s.avatar_url||void 0}),e.jsx(E,{children:((r=s.name)==null?void 0:r.slice(0,1))||"?"})]}),e.jsx("span",{className:"truncate",children:s.name||"User"})]}),e.jsx(x,{size:"icon",variant:"ghost",onClick:()=>as(s.user_id),"aria-label":"Cancel",children:e.jsx(T,{className:"h-4 w-4"})})]},s.user_id)})]})]})]})]})]})]})]}),e.jsx(Ae,{open:Ke,onOpenChange:U,children:e.jsxs(re,{children:[e.jsxs(ne,{children:[e.jsx(le,{children:t("profileSocial.friendsModalTitle")}),e.jsx(de,{children:t("profileSocial.friendsModalDesc")})]}),e.jsx("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto pr-1",children:ue.length?ue.map(s=>{var r;return e.jsxs("div",{className:"flex items-center gap-3 group",children:[e.jsxs("button",{onClick:()=>{U(!1),f(`/profile/${s.username||s.user_id}`)},className:"flex items-center gap-3 text-left flex-1 hover:bg-muted/30 p-2 rounded-md",children:[e.jsxs($,{className:"h-8 w-8",children:[e.jsx(A,{src:s.avatar_url||void 0}),e.jsx(E,{children:((r=s.name)==null?void 0:r.slice(0,1))||"?"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:s.name||"User"}),s.username&&e.jsxs("p",{className:"text-xs text-muted-foreground truncate",children:["@",s.username]})]})]}),p&&s.user_id!==(i==null?void 0:i.id)&&e.jsx(x,{size:"icon",variant:"ghost",className:"opacity-60 hover:opacity-100",onClick:()=>ke(s.user_id),"aria-label":"Remove friend",children:e.jsx(T,{className:"h-4 w-4"})})]},s.user_id)}):e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:t("profileSocial.noFriendsYet")})})]})}),e.jsx(Ae,{open:Qe,onOpenChange:M,children:e.jsxs(re,{className:"max-w-lg",children:[e.jsxs(ne,{children:[e.jsx(le,{children:t("profileSocial.editProfileShort")}),e.jsx(de,{children:t("profileSocial.basicDetails")||"Basic details"})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"relative",children:e.jsxs($,{className:"h-16 w-16",children:[e.jsx(A,{src:S||(a.avatar_url?`${a.avatar_url}${a.avatar_url.includes("?")?"&":"?"}v=${ve}`:void 0)}),e.jsx(E,{children:((De=a.name)==null?void 0:De.slice(0,1))||"U"})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm font-medium",children:t("profileSocial.profilePhoto")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(x,{size:"sm",variant:"outline",onClick:()=>{var s;return(s=we.current)==null?void 0:s.click()},children:t("profileSocial.profilePhoto")||"Photo"}),S&&e.jsx(x,{size:"sm",variant:"ghost",onClick:()=>{H(void 0),B(null)},children:t("profileSocial.cancel")})]}),e.jsx("input",{ref:we,type:"file",accept:"image/*",className:"hidden",onChange:s=>{var d;const r=(d=s.target.files)==null?void 0:d[0];if(!r)return;if(r.size>2*1024*1024){h({description:"Max 2MB"});return}B(r);const l=URL.createObjectURL(r);H(l)}})]})]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:t("profileSocial.username")}),e.jsx(I,{value:w,onChange:s=>_e(s.target.value)}),P==="checking"&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:t("profileSocial.checkingUsername")}),P==="available"&&e.jsx("p",{className:"text-xs text-green-600 mt-1",children:t("profileSocial.usernameIsAvailable")}),P==="taken"&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:t("profileSocial.usernameIsTaken")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:t("profileSocial.name")||"Name"}),e.jsx(I,{value:Z,onChange:s=>Ne(s.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:t("profileSocial.bio")}),e.jsx(I,{value:ee,onChange:s=>ye(s.target.value)})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(x,{variant:"outline",onClick:()=>M(!1),children:t("profileSocial.cancel")}),e.jsx(x,{onClick:is,children:t("profileSocial.save")})]})]})})]})},ws=()=>e.jsxs("div",{className:"space-y-8 stagger-children",children:[e.jsx(N,{variant:"subtle",children:e.jsxs(y,{className:"pt-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start gap-4",children:[e.jsx(o,{className:"h-20 w-20 rounded-full"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(o,{className:"h-6 w-48"}),e.jsx(o,{className:"h-4 w-32"}),e.jsx(o,{className:"h-3 w-72"}),e.jsxs("div",{className:"flex gap-6 mt-2",children:[e.jsx(o,{className:"h-4 w-24"}),e.jsx(o,{className:"h-4 w-32"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{className:"h-8 w-24"}),e.jsx(o,{className:"h-8 w-24"})]})]}),e.jsx("div",{className:"mt-6 grid grid-cols-2 md:grid-cols-5 gap-3 text-sm",children:Array.from({length:5}).map((m,i)=>e.jsx(o,{className:"h-20 w-full rounded-md"},i))})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[e.jsx("div",{className:"lg:col-span-7 space-y-6",children:e.jsxs(N,{variant:"subtle",children:[e.jsxs(C,{children:[e.jsx(o,{className:"h-6 w-40"}),e.jsx(o,{className:"h-4 w-64 mt-2"})]}),e.jsx(y,{children:e.jsx("div",{className:"grid grid-cols-2 gap-3",children:Array.from({length:4}).map((m,i)=>e.jsx(o,{className:"h-14 w-full rounded-md"},i))})})]})}),e.jsxs("div",{className:"lg:col-span-5 space-y-6",children:[e.jsxs(N,{variant:"subtle",children:[e.jsxs(C,{children:[e.jsx(o,{className:"h-6 w-40"}),e.jsx(o,{className:"h-4 w-56 mt-2"})]}),e.jsx(y,{children:e.jsx("div",{className:"space-y-2",children:Array.from({length:7}).map((m,i)=>e.jsx(o,{className:"h-10 w-full rounded-md"},i))})})]}),e.jsxs(N,{variant:"subtle",children:[e.jsxs(C,{children:[e.jsx(o,{className:"h-6 w-32"}),e.jsx(o,{className:"h-4 w-40 mt-2"})]}),e.jsx(y,{children:e.jsx("div",{className:"space-y-2",children:Array.from({length:3}).map((m,i)=>e.jsx(o,{className:"h-8 w-full rounded-md"},i))})})]})]})]})]});export{Ds as default};
